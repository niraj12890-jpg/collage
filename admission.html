<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Admission | Kisan Inter College</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
body { background:#f4f6f9; }
.admission-box { max-width:600px; margin:auto; background:#fff; padding:30px; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,0.1);}
</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
<div class="container">
<a class="navbar-brand" href="index.html">Kisan Inter College</a>
<div class="ms-auto">
<a href="index.html" class="btn btn-outline-light btn-sm">Home</a>
</div>
</div>
</nav>

<!-- Admission Form -->
<div class="container py-5">
<div class="admission-box">
<h3 class="text-center mb-4">Student Admission Form</h3>

<form id="admissionForm">

<div class="mb-3">
<label class="form-label">Full Name</label>
<input type="text" class="form-control" id="name" required>
</div>

<div class="mb-3">
<label class="form-label">Date of Birth</label>
<input type="date" class="form-control" id="dob" required>
</div>

<div class="mb-3">
<label class="form-label">Mobile Number</label>
<input type="tel" class="form-control" id="mobile" maxlength="10" pattern="[0-9]{10}" placeholder="10 digits" required>
</div>

<div class="mb-3">
<label class="form-label">Class</label>
<select class="form-control" id="classSelect" required>
<option value="">Select Class</option>
<option value="11">Class 11</option>
<option value="12">Class 12</option>
</select>
</div>

<button type="submit" class="btn btn-primary w-100">
Submit Admission
<span id="spinner" class="spinner-border spinner-border-sm ms-2" style="display:none;"></span>
</button>

</form>

<p class="mt-3 text-center">
Total Students Registered: <strong><span id="totalStudents">0</span></strong>
</p>
</div>
</div>

<!-- Footer -->
<footer class="bg-dark text-white text-center py-3">
&copy; 2025 Kisan Inter College
</footer>

<!-- Scripts -->
<script>
const admissionForm = document.getElementById("admissionForm");
const spinner = document.getElementById("spinner");
const totalStudents = document.getElementById("totalStudents");

// ðŸ”´ Replace with your deployed Google Script / backend
const scriptURL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";

// Load total students count
fetch(scriptURL + "?action=count")
.then(res => res.json())
.then(data => { totalStudents.textContent = data.total; })
.catch(()=>{ totalStudents.textContent = "0"; });

// Submit form
admissionForm.addEventListener("submit", e=>{
e.preventDefault();
spinner.style.display="inline-block";

const payload = {
action: "admission",
fullName: document.getElementById("name").value,
dob: document.getElementById("dob").value,
mobile: document.getElementById("mobile").value,
class: document.getElementById("classSelect").value
};

fetch(scriptURL, {
method:"POST",
body:JSON.stringify(payload)
})
.then(res=>res.json())
.then(resp=>{
spinner.style.display="none";
alert("Admission Successful!\nRegistration No: "+resp.registration);
admissionForm.reset();
return fetch(scriptURL+"?action=count");
})
.then(r=>r.json())
.then(c=> totalStudents.textContent=c.total)
.catch(err=>{
spinner.style.display="none";
alert("Error submitting form. Please try again.");
});
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
